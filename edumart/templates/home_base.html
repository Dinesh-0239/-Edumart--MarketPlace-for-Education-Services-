{% load static %}
<!doctype html>
<html lang="en">
    
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{% block title %} {% endblock %}</title>
        
        <link rel="icon" href="{% static 'appicon.ico' %}" type="image/icon">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link rel="stylesheet" href="{% static 'css/home_base_style.css' %}">
    {% block style %} {% endblock %}

</head>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top navbar-scroll">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <a class="navbar-brand d-flex align-items-center" href="{% url 'profile' %}">
                <img src="{% static 'appicon.ico' %}" alt="EduMart Logo" width="30" class="me-2">
                <span class="fw-bold">EduMart</span>
            </a>
            <form class="d-flex mx-auto w-50" action="{% url 'search_services' %}" method="GET">
                <input class="form-control me-2" type="search" placeholder="Search by title, category, or provider..." aria-label="Search" name="q" value="{{ request.GET.q }}">
                <button class="btn btn-outline-primary" type="submit">Search</button>
            </form>
            <div class="d-flex align-items-center">
                <button class="btn btn-outline-primary me-2 fw-normal" onclick="window.location.href='{% url 'service_list' %}'">Browse
                    Services</button>
                {% if user.is_service_provider %}
                <button class="btn btn-outline-primary me-3 fw-normal"
                    onclick="window.location.href='{% url 'create_service' %}'">Add New Service</button>
                {% endif %}
                <a href="{% url 'profile' %}" class="user-profile d-flex align-items-center text-decoration-none">
                    <span class="fst-italic me-2 m-0 p-0 user-username {% if user.is_service_provider %}service-provider-username{% else %}customer-username{% endif %}">
                        {{ user.username }}
                    </span>
                    
                    <!-- ✅ Fix: Check if user has a profile picture -->
                    {% if user.profile_picture %}
                        <img src="{{ user.profile_picture.url }}" alt="User" class="rounded-circle profile-pic m-0 p-0"
                            width="40" height="40">
                    {% endif %}
                </a>
                <a href="{% url 'logout' %}" class="btn btn-dark ms-3 fw-normal">Logout</a>
            </div>
        </div>
    </nav>

    {% block content %} {% endblock %}

    <!-- Footer -->
    <footer class="footer fixed-bottom">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <span class="text-body-secondary">© {% now 'Y' %} EduMart</span>
            <ul class="nav list-unstyled d-flex">
                <li class="ms-3"><a class="text-body-secondary" href="#"><img src="{% static 'images/twitter.svg' %}"
                            alt="twitter-icon" height="20" width="20"></a></li>
                <li class="ms-3"><a class="text-body-secondary" href="#"><img src="{% static 'images/instagram.svg' %}"
                            alt="instagram-icon" height="20" width="20"></a></li>
                <li class="ms-3"><a class="text-body-secondary" href="#"><img src="{% static 'images/facebook.svg' %}"
                            alt="facebook-icon" height="20" width="20"></a></li>
            </ul>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    {% block script %} {% endblock %}
</body>

</html>
